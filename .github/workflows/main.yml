name: CI/CD Pipeline

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  ci:
    runs-on: ubuntu-latest
    name: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –∏ —Å–±–æ—Ä–∫–∞

    steps:
      # 1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É GitHub
      - name: üõë Checkout –∫–æ–¥–∞
        uses: actions/checkout@v4

      # 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Node.js –≤–µ—Ä—Å–∏–∏ 18 –∏ –∫—ç—à–∏—Ä—É–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ npm
      - name: ‚¨áÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      # 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. --frozen-lockfile ‚Äî —á—Ç–æ–±—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è—Ç—å package-lock.json
      - name: üì¶ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
        run: npm ci

      # 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∏–ª—å –∫–æ–¥–∞ —á–µ—Ä–µ–∑ ESLint
      - name: üîç –õ–∏–Ω—Ç–∏–Ω–≥ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞)
        run: npm run lint

      # 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø—ã TypeScript. --pretty ‚Äî –∫—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥
      - name: ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ (TypeScript)
        run: npm run type-check


      # 6. –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ–µ–∫—Ç. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ —Å–∫—Ä–∏–ø—Ç, —á—Ç–æ –∏ –ª–æ–∫–∞–ª—å–Ω–æ: tsc -b && vite build
      - name: üõ†Ô∏è –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
        run: npm run build

        
      # 7. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–±–æ—Ä–∫–∏, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–ª—å—à–µ
      - name: üì¶ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–±–æ—Ä–∫–∏
        uses: actions/upload-artifact@v4
        if: success()
        with:
          name: build
          path: dist/  # –í–ê–ñ–ù–û: Vite –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–±–∏—Ä–∞–µ—Ç –≤ –ø–∞–ø–∫—É dist/, –Ω–µ build!
