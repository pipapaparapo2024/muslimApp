name: CI/CD Pipeline

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  ci:
    runs-on: ubuntu-latest
    name: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –∏ —Å–±–æ—Ä–∫–∞

    steps:
      - name: üõë Checkout –∫–æ–¥–∞
        uses: actions/checkout@v4

      - name: ‚¨áÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'

      - name: üì¶ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
        run: npm ci

      - name: üîç –õ–∏–Ω—Ç–∏–Ω–≥ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è –∫–æ–¥–∞)
        run: npm run lint

      - name: ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ (TypeScript)
        run: npm run type-check

      - name: üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
        run: npm run test -- --ci --coverage --watchAll=false

      - name: üõ†Ô∏è –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
        run: npm run build

      - name: üì¶ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–±–æ—Ä–∫–∏
        uses: actions/upload-artifact@v3
        if: success()
        with:
          name: build
          path: dist/
